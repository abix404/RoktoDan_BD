{% extends 'base.html' %}
{% load static %}

{% block title %}Blood Donation - Save Lives{% endblock %}

{% block extra_css %}
<link rel="stylesheet" type="text/css" href="{% static 'css/home.css' %}">
{% endblock %}

{% block content %}
    <!-- Loading Screen -->
    <div class="loading-overlay">
        <div class="loading-content">
            <img src="{% static 'images/bangladesh_logo.png' %}" class="loading-image" alt="Blood Donation Logo">
            <span class="loading-text">RoktoDan BD</span>
        </div>
    </div>

    <!-- Floating Background Elements -->
    <div class="floating-elements">
        <svg class="floating-element" width="60" height="60" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
        </svg>
        <svg class="floating-element" width="40" height="40" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
        </svg>
        <svg class="floating-element" width="80" height="80" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
        </svg>
    </div>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <div class="hero-content">
                <div class="hero-visual">
                    <div class="hero-shape">
                        <svg class="hero-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                        </svg>
                    </div>
                </div>
                <div class="hero-text">
                    <h1>Save Life<br>Donate Blood</h1>
                    <p>Through timely and accessible donations, you help save lives when every second counts. By donating blood, you not only reduce the burden on blood banks and ease dependency on others, but also become part of a smarter, connected network that values and recognizes every selfless act.</p>
                    <a href="{% url 'find_blood' %}" class="cta-btn">
                        <span>Get Blood Now</span>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M5 12h14M12 5l7 7-7 7"/>
                        </svg>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- How to get Blood Section -->
    <section class="how-to-get-blood">
        <div class="container">
            <div class="section-header animate-on-scroll">
                <h2>How to get Blood?</h2>
                <div class="heartbeat-line">
                    <svg class="heartbeat-svg" viewBox="0 0 500 60">
                        <path class="heartbeat-path" d="M0,30 L100,30 L110,10 L120,50 L130,10 L140,30 L180,30 L190,20 L200,40 L210,20 L220,30 L260,30 L270,25 L280,35 L290,25 L300,30 L500,30"/>
                    </svg>
                </div>
            </div>

            <div class="steps-grid">
                <div class="step-card animate-on-scroll" style="animation-delay: 0.1s">
                    <div class="step-number">1</div>
                    <div class="step-icon">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                            <path d="M7.5 4.21l4.5 2.6 4.5-2.6m-9 15.58V14.6L3 12m18 0l-4.5 2.6v5.19M3.27 6.96L12 12.01l8.73-5.05M12 22.08V12"/>
                        </svg>
                    </div>
                    <h3>Register & Search</h3>
                    <p>Create your profile and search for available blood donors in your area using our smart matching system.</p>
                </div>

                <div class="step-card animate-on-scroll" style="animation-delay: 0.2s">
                    <div class="step-number">2</div>
                    <div class="step-icon">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                        </svg>
                    </div>
                    <h3>Connect & Verify</h3>
                    <p>Connect with verified donors through our platform and confirm availability for immediate or scheduled donations.</p>
                </div>

                <div class="step-card animate-on-scroll" style="animation-delay: 0.3s">
                    <div class="step-number">3</div>
                    <div class="step-icon">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                        </svg>
                    </div>
                    <h3>Save Lives</h3>
                    <p>Complete the donation process safely at certified centers and help save precious lives in your community.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Mission Section -->
    <section class="mission">
        <div class="container">
            <div class="mission-content animate-on-scroll">
                <h2>Our Mission</h2>
                <p>To save valuable time during emergencies by building a smart and accessible blood network that empowers selfless donors through recognition and credits, reduces dependency on others, lessens the burden on blood banks, and fosters a culture of regular blood donation.</p>
            </div>
        </div>
    </section>

    <!-- Collaborators Section -->
    <section class="collaborators">
        <div class="container">
            <h2 class="animate-on-scroll">Our Collaborators</h2>
            <div class="collaborators-grid">
                <div class="collaborator-card animate-on-scroll" style="animation-delay: 0.1s">
                    <div class="collaborator-name">NCC</div>
                </div>
                <div class="collaborator-card animate-on-scroll" style="animation-delay: 0.2s">
                    <div class="collaborator-name">NSS</div>
                </div>
                <div class="collaborator-card animate-on-scroll" style="animation-delay: 0.3s">
                    <div class="collaborator-name">YMCA</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Image Slider Section -->
    <section class="image-slider-section">
        <div class="container">
            <div class="section-header animate-on-scroll">
                <h2>Our Impact Gallery</h2>
                <p>Witness the lives we've touched through blood donation</p>
            </div>

            <div class="slider-container">
                <div class="slider-wrapper">
                    <div class="slider-track" id="sliderTrack">
                        <div class="slide active">
                            <img src="{% static 'images/slider_doctor_1.png' %}" alt="Blood donation drive">
                            <div class="slide-overlay">
                                <h3>Community Blood Drive</h3>
                                <p>Saving lives together</p>
                            </div>
                        </div>
                        <div class="slide">
                            <img src="{% static 'images/slider_5.png' %}" alt="Medical team">
                            <div class="slide-overlay">
                                <h3>Medical Excellence</h3>
                                <p>Professional care always</p>
                            </div>
                        </div>
                        <div class="slide">
                            <img src="{% static 'images/slider_7.png' %}" alt="Donor appreciation">
                            <div class="slide-overlay">
                                <h3>Hero Recognition</h3>
                                <p>Celebrating our donors</p>
                            </div>
                        </div>
                        <div class="slide">
                            <img src="{% static 'images/slider_donation_1.png' %}" alt="Blood donation">
                            <div class="slide-overlay">
                                <h3>Life Saving Moment</h3>
                                <p>Every drop counts</p>
                            </div>
                        </div>
                        <div class="slide">
                            <img src="https://images.unsplash.com/photo-1576091160550-2173dba999ef?w=400&h=300&fit=crop" alt="Hospital care">
                            <div class="slide-overlay">
                                <h3>Emergency Response</h3>
                                <p>Ready when needed</p>
                            </div>
                        </div>
                        <div class="slide">
                            <img src="{% static 'images/slider_2.png' %}" alt="Volunteer team">
                            <div class="slide-overlay">
                                <h3>Volunteer Spirit</h3>
                                <p>United for a cause</p>
                            </div>
                        </div>
                        <div class="slide">
                            <img src="{% static 'images/slider_6.png' %}" alt="Blood bank">
                            <div class="slide-overlay">
                                <h3>Safe Storage</h3>
                                <p>Maintaining quality</p>
                            </div>
                        </div>
                        <div class="slide">
                            <img src="{% static 'images/slider_4.png' %}" alt="Community event">
                            <div class="slide-overlay">
                                <h3>Community Events</h3>
                                <p>Building awareness</p>
                            </div>
                        </div>
                        <div class="slide">
                            <img src="{% static 'images/slider_3.png' %}" alt="Success story">
                            <div class="slide-overlay">
                                <h3>Success Stories</h3>
                                <p>Lives transformed</p>
                            </div>
                        </div>
                        <div class="slide">
                            <img src="https://images.unsplash.com/photo-1576091160550-2173dba999ef?w=400&h=300&fit=crop" alt="Future vision">
                            <div class="slide-overlay">
                                <h3>Future Vision</h3>
                                <p>Expanding our reach</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Navigation Controls -->
                <div class="slider-controls">
                    <button class="slider-btn prev-btn" id="prevBtn">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M15 18l-6-6 6-6"/>
                        </svg>
                    </button>
                    <button class="slider-btn next-btn" id="nextBtn">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 18l6-6-6-6"/>
                        </svg>
                    </button>
                </div>

                <!-- Dots Indicator -->
                <div class="slider-dots" id="sliderDots">
                    <span class="dot active" data-slide="0"></span>
                    <span class="dot" data-slide="1"></span>
                    <span class="dot" data-slide="2"></span>
                    <span class="dot" data-slide="3"></span>
                    <span class="dot" data-slide="4"></span>
                    <span class="dot" data-slide="5"></span>
                    <span class="dot" data-slide="6"></span>
                    <span class="dot" data-slide="7"></span>
                    <span class="dot" data-slide="8"></span>
                    <span class="dot" data-slide="9"></span>
                </div>
            </div>
        </div>
    </section>

    <script>
        // Intersection Observer for scroll animations
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate');
                }
            });
        }, observerOptions);

        // Observe all elements with animate-on-scroll class
        document.querySelectorAll('.animate-on-scroll').forEach(el => {
            observer.observe(el);
        });

        // Smooth scrolling for CTA button
        const ctaBtn = document.querySelector('.cta-btn');
        if (ctaBtn) {
            ctaBtn.addEventListener('click', (e) => {
                e.preventDefault();
                const howToSection = document.querySelector('.how-to-get-blood');
                if (howToSection) {
                    howToSection.scrollIntoView({
                        behavior: 'smooth'
                    });
                }
            });
        }

        // Parallax effect for hero section
        window.addEventListener('scroll', () => {
            const scrolled = window.pageYOffset;
            const hero = document.querySelector('.hero');
            if (hero) {
                hero.style.transform = `translateY(${scrolled * 0.5}px)`;
            }
        });

        // Dynamic heartbeat animation trigger
        const heartbeatObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const path = entry.target.querySelector('.heartbeat-path');
                    if (path) {
                        path.style.animation = 'none';
                        setTimeout(() => {
                            path.style.animation = 'drawHeartbeat 3s ease-in-out infinite';
                        }, 100);
                    }
                }
            });
        }, { threshold: 0.3 });

        const heartbeatSection = document.querySelector('.heartbeat-line');
        if (heartbeatSection) {
            heartbeatObserver.observe(heartbeatSection);
        }

        // Add hover effect to step cards
        document.querySelectorAll('.step-card').forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-10px) scale(1.02)';
            });

            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0) scale(1)';
            });
        });

        // Stagger animation for collaborator cards
        const collaboratorCards = document.querySelectorAll('.collaborator-card');
        collaboratorCards.forEach((card, index) => {
            card.style.animationDelay = `${index * 0.1}s`;
        });

        // Loading screen removal
        setTimeout(() => {
            const loadingOverlay = document.querySelector('.loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.style.display = 'none';
            }
        }, 2500);

        // Add random floating animation to background elements
        document.querySelectorAll('.floating-element').forEach(element => {
            const randomDelay = Math.random() * 10;
            const randomDuration = 15 + Math.random() * 10;
            element.style.animationDelay = `${randomDelay}s`;
            element.style.animationDuration = `${randomDuration}s`;
        });

        // Add click ripple effect to buttons
        const rippleBtn = document.querySelector('.cta-btn');
        if (rippleBtn) {
            rippleBtn.addEventListener('click', function(e) {
                const ripple = document.createElement('span');
                const rect = this.getBoundingClientRect();
                const size = Math.max(rect.width, rect.height);
                const x = e.clientX - rect.left - size / 2;
                const y = e.clientY - rect.top - size / 2;

                ripple.style.cssText = `
                    position: absolute;
                    width: ${size}px;
                    height: ${size}px;
                    left: ${x}px;
                    top: ${y}px;
                    background: rgba(255, 255, 255, 0.3);
                    border-radius: 50%;
                    transform: scale(0);
                    animation: ripple 0.6s ease-out;
                    pointer-events: none;
                `;

                this.appendChild(ripple);

                setTimeout(() => {
                    ripple.remove();
                }, 600);
            });
        }

        // Add CSS for ripple animation
        const rippleStyle = document.createElement('style');
        rippleStyle.textContent = `
            @keyframes ripple {
                to {
                    transform: scale(2);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(rippleStyle);

        // Image Slider Functionality
        let currentSlide = 0;
        const totalSlides = 10;
        let slidesToShow = window.innerWidth <= 480 ? 1 : window.innerWidth <= 768 ? 2 : 4;
        let maxSlideIndex = totalSlides - slidesToShow;

        const sliderTrack = document.getElementById('sliderTrack');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const dots = document.querySelectorAll('.dot');

        function updateSlider() {
            if (!sliderTrack) return;

            const translateX = -(currentSlide * (100 / slidesToShow));
            sliderTrack.style.transform = `translateX(${translateX}%)`;

            // Update dots
            dots.forEach((dot, index) => {
                dot.classList.toggle('active', index === currentSlide);
            });
        }

        function nextSlide() {
            currentSlide = currentSlide >= maxSlideIndex ? 0 : currentSlide + 1;
            updateSlider();
        }

        function prevSlide() {
            currentSlide = currentSlide <= 0 ? maxSlideIndex : currentSlide - 1;
            updateSlider();
        }

        // Event listeners for slider
        if (nextBtn) {
            nextBtn.addEventListener('click', nextSlide);
        }
        if (prevBtn) {
            prevBtn.addEventListener('click', prevSlide);
        }

        dots.forEach((dot, index) => {
            dot.addEventListener('click', () => {
                currentSlide = Math.min(index, maxSlideIndex);
                updateSlider();
            });
        });

        // Auto-scroll for slider
        let autoSlideInterval = setInterval(nextSlide, 5000);

        // Pause auto-scroll on hover
        const sliderContainer = document.querySelector('.slider-container');
        if (sliderContainer) {
            sliderContainer.addEventListener('mouseenter', () => {
                clearInterval(autoSlideInterval);
            });

            sliderContainer.addEventListener('mouseleave', () => {
                autoSlideInterval = setInterval(nextSlide, 5000);
            });
        }

        // Handle window resize for responsive slider
        window.addEventListener('resize', () => {
            slidesToShow = window.innerWidth <= 480 ? 1 : window.innerWidth <= 768 ? 2 : 4;
            maxSlideIndex = totalSlides - slidesToShow;

            // Adjust current slide if needed
            if (currentSlide > maxSlideIndex) {
                currentSlide = maxSlideIndex;
            }

            updateSlider();
        });

        // Initialize slider
        updateSlider();
    </script>
{% endblock %}